<!-- views/profile.ejs -->
<!doctype html>
<html>
<head>

    <meta charset="UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	
    <title>Battleship</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/battleship.css">
</head>
<body>
<div class="container">

    <div class="page-header text-center">
        <h1>Battleship</h1>
    </div>
	
	<div class="row">
		<!-- The game div -->
		<div class="col-lg-4" id="OpponentGrid">
			<div class="page-header text-center">
				<h3>Opponent's Grid</h3>
			</div>
			
			<ul id="OpponentShips"></ul>
		
			<div class="row show-grid">
				<div class="col-xs-1 square"></div>
				<div class="col-xs-1 square"><div class="content">A</div></div>
				<div class="col-xs-1 square"><div class="content">B</div></div>
				<div class="col-xs-1 square"><div class="content">C</div></div>
				<div class="col-xs-1 square"><div class="content">D</div></div>
				<div class="col-xs-1 square"><div class="content">E</div></div>
				<div class="col-xs-1 square"><div class="content">F</div></div>
				<div class="col-xs-1 square"><div class="content">G</div></div>
				<div class="col-xs-1 square"><div class="content">H</div></div>
				<div class="col-xs-1 square"><div class="content">I</div></div>
				<div class="col-xs-1 square"><div class="content">J</div></div>
			</div>
			<div class="row show-grid" id="1">
				<div class="col-xs-1 square"><div class="content">1</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="2">
				<div class="col-xs-1 square"><div class="content">2</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="3">
				<div class="col-xs-1 square"><div class="content">3</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="4">
				<div class="col-xs-1 square"><div class="content">4</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="5">
				<div class="col-xs-1 square"><div class="content">5</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="6">
				<div class="col-xs-1 square"><div class="content">6</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="7">
				<div class="col-xs-1 square"><div class="content">7</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="8">
				<div class="col-xs-1 square"><div class="content">8</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="9">
				<div class="col-xs-1 square"><div class="content">9</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10,9"></div>
			</div>
			<div class="row show-grid" id="10">
				<div class="col-xs-1 square"><div class="content">10</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
		</div>
		<div class="col-lg-4" id="PlayerGrid">
		
			<div class="page-header text-center">
				<h3>Your Grid</h3>
			</div>
			
			<ul id="PlayerShips"></ul>
			
			<div class="row show-grid">
				<div class="col-xs-1 square"></div>
				<div class="col-xs-1 square"><div class="content">A</div></div>
				<div class="col-xs-1 square"><div class="content">B</div></div>
				<div class="col-xs-1 square"><div class="content">C</div></div>
				<div class="col-xs-1 square"><div class="content">D</div></div>
				<div class="col-xs-1 square"><div class="content">E</div></div>
				<div class="col-xs-1 square"><div class="content">F</div></div>
				<div class="col-xs-1 square"><div class="content">G</div></div>
				<div class="col-xs-1 square"><div class="content">H</div></div>
				<div class="col-xs-1 square"><div class="content">I</div></div>
				<div class="col-xs-1 square"><div class="content">J</div></div>
			</div>
			<div class="row show-grid" id="1">
				<div class="col-xs-1 square"><div class="content">1</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="2">
				<div class="col-xs-1 square"><div class="content">2</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="3">
				<div class="col-xs-1 square"><div class="content">3</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="4">
				<div class="col-xs-1 square"><div class="content">4</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="5">
				<div class="col-xs-1 square"><div class="content">5</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="6">
				<div class="col-xs-1 square"><div class="content">6</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="7">
				<div class="col-xs-1 square"><div class="content">7</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="8">
				<div class="col-xs-1 square"><div class="content">8</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
			<div class="row show-grid" id="9">
				<div class="col-xs-1 square"><div class="content">9</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10,9"></div>
			</div>
			<div class="row show-grid" id="10">
				<div class="col-xs-1 square"><div class="content">10</div></div>
				<div class="col-xs-1 gamesquare" id="1"></div>
				<div class="col-xs-1 gamesquare" id="2"></div>
				<div class="col-xs-1 gamesquare" id="3"></div>
				<div class="col-xs-1 gamesquare" id="4"></div>
				<div class="col-xs-1 gamesquare" id="5"></div>
				<div class="col-xs-1 gamesquare" id="6"></div>
				<div class="col-xs-1 gamesquare" id="7"></div>
				<div class="col-xs-1 gamesquare" id="8"></div>
				<div class="col-xs-1 gamesquare" id="9"></div>
				<div class="col-xs-1 gamesquare" id="10"></div>
			</div>
		</div>
		
		<!-- The chat div -->
		<div class="col-lg-4">
			<div class="page-header text-center">
				<h3>Chat</h3>
			</div>
		
			<form action="">
			  <input id="m" autocomplete="off" /><button id="btn" type="submit">Send</button>
			</form>
			<ul id="messages"></ul>
		</div>
	</div>
	
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="js/ShotChecker.js"></script>
	<script>
	  var socket = io();
	  
	  $('form').submit(function(){
		socket.emit('chat message', '<strong><%=id%></strong>: '+ $('#m').val());
		$('#m').val('');
		return false;
	  });
	  
	  socket.on('chat message', function(msg){
		$('#messages').append($('<li>').html(msg));
	  });
	</script>
	
	<script>
		var opponentGrid =<%-JSON.stringify(opponent)%>;
		var playerGrid =<%-JSON.stringify(player)%>;
		
		$('.gamesquare').click(function(){
			var y = $(this).attr("id");
			var x = $(this).parent().attr("id");
			var gridName = $(this).parent().parent().attr("id");
			
			console.log("Clicked "+x+","+y+" on grid "+gridName);
		});
		
		$( document ).ready(function() {
			// Show the opponent's ship names
			for(i = 0; i < opponentGrid.shiplist.length; i++)
			{
				var ship = opponentGrid.shiplist[i];
				$('#OpponentShips').append($('<li>').text(ship.name));
			}
			// color the player's ships
			for(i = 0; i < playerGrid.shiplist.length; i++)
			{
				var ship = playerGrid.shiplist[i];
				$('#PlayerShips').append($('<li>').text(ship.name));
				
				x = ship.pos_x
				y = ship.pos_y
				gridSquare = $('#PlayerGrid > #'+y+' > #'+x)
				// Color the squares of the ship
				for(shipSection = 0; shipSection < ship.length; shipSection++)
				{
					gridSquare.css('background-color','#'+i+i+i+i+i+i)
					switch(ship.direction)
					{
						case "up":
							y--;
							break;
						case "down":
							y++;
							break;
						case "left":
							x--;
							break;
						case "right":
							x++;
							break;
					}
					gridSquare = $('#PlayerGrid > #'+y+' > #'+x)
				}
			}
		});
	</script>
	
</div>
</body>
</html>